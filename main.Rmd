---
title: "R Notebook"
output: html_notebook
---


```{r}
library(dplyr)

library(terra)
library(sf)
library(whitebox)
library(httr)
library(arcpullr) #would be cool if it worked but right now it does not seem to work right 
library(rgee)

library(ForestTools)
library(lidR)


```

# Downloading DEM Tiles
```{r}
image_service_url <- "https://gis.dogami.oregon.gov/arcgis/rest/services/lidar/CANOPY_HEIGHT_MODEL_MOSAIC/ImageServer"


aoi <-st_read("OregonLidarData.gpkg", layer = "AOI")
bbox <-st_bbox(aoi)
# Define the bounding box (xmin, ymin, xmax, ymax)
#bbox <- c(xmin = -122.5, ymin = 44.0, xmax = -122.49, ymax = 44.01)

query_url <- paste0(
  image_service_url,
  "/exportImage?bbox=",
  paste(bbox, collapse = ","),
  "&bboxSR=4326&size=1000,1000&imageSR=4326&format=tiff&f=image"
)

response <- httr::GET(query_url)

if (response$status_code == 200) {
  # Write the content to a file
  writeBin(httr::content(response, "raw"), "output.tiff")
} else {
  stop("Failed to retrieve raster data.")
}

raster_data <- rast("output.tiff")


```


# Google Earth Engine
to compare the differences between the Oregon LiDAR and Meta 1m Tree data

```{r}

```





